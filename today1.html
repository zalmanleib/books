<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Morah Shiur — Rambam Daily</title>
  <style>
    body{margin:0;font-family:sans-serif;background:#0f172a;color:#f5f5f5;display:flex;align-items:center;justify-content:center;padding:10px}
    .container{max-width:900px;width:100%;background:#1e293b;border-radius:10px;padding:16px;box-shadow:0 6px 20px rgba(0,0,0,0.5)}
    header h1{margin:0 0 10px;text-align:center}
    .controls{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:12px;justify-content:center}
    input,button{padding:6px 10px;border-radius:6px;border:none}
    input{background:#334155;color:#f5f5f5}
    button{cursor:pointer;background:#4c1d95;color:white}
    iframe{width:100%;height:600px;border:0;border-radius:6px;background:white;display:none}
  </style>
</head>
<body>
<div class="container">
  <header>
    <h1>Morah Shiur — Rambam Daily</h1>
  </header>

  <div class="controls">
    <label>Date: <input type="date" id="pickDate"></label>
    <button onclick="showPdf('echod')">Perek Echad</button>
    <button onclick="showPdf('shlosha')">Shlosha Perakim</button>
    <button id="prevBtn">← Prev</button>
    <button id="todayBtn">Today</button>
    <button id="nextBtn">Next →</button>
    <button id="fullscreenBtn">Open Fullscreen</button>
  </div>

  <!-- PDF.js viewer iframe -->
  <iframe id="pdfFrame"></iframe>
</div>

<script>
    let startDateShlosha = new Date("1984-04-28");
    let startDateEchod = new Date("1984-04-28");

    let baseUrlShlosha = "https://s3.amazonaws.com/DvarMalchus/rambam/3/";
    let maxShlosha = 339;

    let baseUrlEchod = "https://s3.amazonaws.com/DvarMalchus/rambam/1/";
    let maxEchod = 1017;

    function getCycleDay(startDate, today, maxDays) {
        let diffTime = today - startDate;
        let diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
        return (diffDays % maxDays) + 1;
    }

    function showPdf(cycleType) {
        let today = new Date();
        let url;
        if (cycleType === "shlosha") {
            let day = getCycleDay(startDateShlosha, today, maxShlosha);
            url = baseUrlShlosha + day + ".pdf";
        } else {
            let day = getCycleDay(startDateEchod, today, maxEchod);
            url = baseUrlEchod + day + ".pdf";
        }

        // Wrap with PDF.js viewer
        let pdfJsUrl = "https://mozilla.github.io/pdf.js/web/viewer.html?file=" + encodeURIComponent(url);

        let frame = document.getElementById("pdfFrame");
        frame.style.display = "block";
        frame.src = pdfJsUrl;

        document.getElementById("fullscreenBtn").onclick = function () {
            window.open(pdfJsUrl, "_blank");
        };
    }
</script>
</body>
</html>
